plugins {
   id "com.android.application"
   id "kotlin-android"
   // The Flutter Gradle Plugin must be applied after the Android and Kotlin Gradle plugins.
   id "dev.flutter.flutter-gradle-plugin"
   // Add Firebase Gradle plugin
   id 'com.google.gms.google-services'
}

android {
   namespace = "com.nikolausfranz.uas_pokedexapp"
   compileSdk = 35
   ndkVersion = flutter.ndkVersion

   compileOptions {
       sourceCompatibility = JavaVersion.VERSION_17
       targetCompatibility = JavaVersion.VERSION_17
   }

   kotlinOptions {
       jvmTarget = '17'
   }

   // Hapus dexOptions karena sudah deprecated di Gradle 8.0
   // dexOptions {
   //     javaMaxHeapSize "4g"
   // }

   defaultConfig {
       applicationId = "com.nikolausfranz.uas_pokedexapp"
       minSdk = 26
       targetSdk = 35
       versionCode = 1
       versionName = "1.0.0"
       multiDexEnabled true
       
       // Add MIUI optimization
       ndk {
           abiFilters 'armeabi-v7a', 'arm64-v8a', 'x86_64'
       }
   }

   buildTypes {
       release {
           // TODO: Add your own signing config for the release build.
           // Signing with the debug keys for now, so `flutter run --release` works.
           signingConfig = signingConfigs.debug
           
           // Add optimization for release
           minifyEnabled true
           shrinkResources true
           proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
       }
       
       debug {
           // Debug configuration
           minifyEnabled false
           shrinkResources false
           signingConfig = signingConfigs.debug
       }
   }

   // Add packaging options
   packagingOptions {
       exclude 'META-INF/DEPENDENCIES'
       exclude 'META-INF/LICENSE'
       exclude 'META-INF/LICENSE.txt'
       exclude 'META-INF/license.txt'
       exclude 'META-INF/NOTICE'
       exclude 'META-INF/NOTICE.txt'
       exclude 'META-INF/notice.txt'
       exclude 'META-INF/ASL2.0'
   }
}

flutter {
   source = "../.."
}

dependencies {
   // Import the Firebase BoM
   implementation platform('com.google.firebase:firebase-bom:32.7.0')
   
   // Firebase dependencies
   implementation 'com.google.firebase:firebase-analytics'
   implementation 'com.google.firebase:firebase-auth'
   implementation 'com.google.firebase:firebase-firestore'
   
   // Add multidex support if needed
   implementation 'androidx.multidex:multidex:2.0.1'
   
   // Add MIUI optimization
   implementation 'androidx.core:core-ktx:1.12.0'
   implementation 'androidx.appcompat:appcompat:1.6.1'
   implementation 'com.google.android.material:material:1.10.0'
}